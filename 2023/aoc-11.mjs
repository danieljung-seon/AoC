const i1 = `...#......
.......#..
#.........
..........
......#...
.#........
.........#
..........
.......#..
#...#.....`;

const i2 = `...........#..........#...........................#....................#......#........................................................#....
...#........................#..............................#...................................................................#............
......................................#...................................................................#...........#.....................
...............................................#...............#.......................#....................................................
..........................................#...........#.............................................#.......................................
..........#.................................................................#................................#..............................
................................#.................................................................................#......#..................
..................................................................#.........................................................................
............................................................#..................#.......................................................#....
................................................#............................................#...............................#..............
.....#..............#..............................................................#................................#.......................
.........................................#...............................................#.................................................#
..............................#................................#.......#....................................................................
........................................................................................................................#...................
...#......#.......#.................#...................#......................................#.......#.......#........................#...
...........................................#...............................#....................................................#...........
...................................................................................#........................................................
.............#............#........................................#.......................................#......#.........................
................................#............................#...............................#..............................................
........................................#.............#.........................#......#......................................#.............
........................................................................................................#.....#.............................
......#............#...............#..............#.........................................................................................
...........#..................#............#.....................#..................................................#.......................
.......................................................................#..................#................#.......................#........
..#...................................#.....................................#.....#..................#......................................
............................................................................................................................................
............................#........................#.........................................#............................................
.......#......................................................................................................................#.............
......................#.......................................................#.............................................................
.#...........................................................#.....#..................................................#.................#...
..................................#....................................................#....................................................
.................................................................................#..............................#...........................
........#.................................#..........#......................................#............#..................................
..................#........................................................#................................................................
.............................#................#......................#...............................#..........................#......#....
..............#......................#..................................................................................#...................
...............................................................................................................#............................
..#.....................#.......................................#...................................................#.......................
..................................#....................#..........................................#.........................................
....................#.....................#......#.........................................................................#.......#........
............................................................#..........#...................................................................#
....#........................#................................................#...........#...............#......#..........................
............................................................................................................................................
..........#............................#....................................................................................................
...............#...............................#......#.............................................#.................................#.....
......................#..........#.........................#.......#..................................................#.....................
...............................................................................................................#..................#........#
............................................................................................................................................
#..........................#...............................................#.......#......#.................................................
............................................................................................................................................
.......#......................................................#............................................................#........#.......
.............................................#.........#............................................#.....#.................................
...............................#.......#....................................................................................................
.................................................................#..........................#..................#............................
..............#.....#.........................................................#......#.....................................................#
.................................................#.......#.............#....................................................................
..............................................................#............................................#................................
.#.......................#...............#.................................#.........................................................#......
....................................#.....................................................#..............................#..................
.....#...........#..............................................................................#.....#.....................................
.................................................................#.................#........................................................
............................................................................................................................................
.................................................#........................................................#.................................
........#.........................................................................................#...........................#..........#..
...............#........#...........#.....#........................#..............................................#................#........
........................................................................................#...................................................
...................................................................................#.........................#..............................
...#..............#....................................................#............................#.......................................
..............................#............................#................................................................................
........................................#.............................................................................................#.....
..............................................#..................#.............#........................#.................#.................
...................................................#.............................................................#..........................
.........#..................................................................................................................................
.......................#.....................................#.......#.....#..............................................................#.
................................................................................................#.....................#.....................
....#...........................#......................#.............................#.......................................#..............
...........................................................................................................#................................
...........#.......#........#..............................#.....................................................#..........................
............................................#...............................................#...............................................
....................................................................#..............#..................#..............#...............#......
.....................................#........................#.............................................................................
...............................................#............................................................#.................#............#
............................................................................................................................................
....#.......#...........................................................................................................#.........#.........
...................................#................#...........#..............................#............................................
............................................................................................................................................
.......................................................................#...........#......#..........#.......#..............................
..............................................................................#......................................................#......
...........................#.....................#..................................................................#.......................
..#............#............................#................................................#..............................................
...........................................................................................................................................#
........................................#...............#............#..........#......................................#....................
............#................................................#..............................................................................
.......#............................#...............#....................................#............#..........................#..........
......................#....................................................#................................................................
...............................................................................................#.............#.....#........................
..................#....................................#.........#...............#..........................................................
.............#...............#................#........................................#.................................................#..
...................................#....................................................................#...................#...............
.........................................#..........#.................#.....................................................................
................#............................................................#..............................................................
..........#.....................#........................#.....................................................................#............
....#.................................#.............................................................................................#.......
......................#.....#.......................................................................................#.......................
..............................................#.........................................#...................................................
..........................................................................................................#.................................
...................................................................#.........................................................#..............
.........#....................#.........#.........#...........#....................................#......................................#.
............................................................................................................................................
..#........................................................................#...............#.............................#..................
..............#...........#..........................................................#..........................................#...........
...................#.................................#...............................................#......................................
...............................#......................................................................................................#.....
...........................................#.................#........#.......................#.............................................
.....................................#.....................................................................#......#.......#.................
................#...............................#................................#......#..........#......................................#.
........................#...................................................................................................................
..............................#................................................................................................#............
.........................................................#...................#..........................#...................................
....#.......................................................................................................................................
........................................................................#........................#......................#.............#.....
............#...............#.............#.........#............................#........#................#................................
.....................#...............#..............................................................................#.......................
..................................................................#......................................................................#..
............................................................................................................................................
..............#........................................#.....................#.......#......................................................
........................#..............................................#..............................................#........#............
........................................#........................................#..........................................................
.......#........................#...................#.........#..............................................#..............................
..#................#......................................................................#........................................#........
.................................................................................................#.......................#..................
..............................................#.............................................................................................
.....#........#...........................................................................................#.........#........#..............
.................................................................................#..........#..........................................#....
..........................#...................................#.........#..............#.........................................#..........
............................................................................................................................................
....................................................................#.......#...................#...........................................
......................#.............#.............#.....................................................#...................................
........................................................#........................................................#..........................
..#..........#..........................#....................................................................................#.......#......`;

function injectAt(str, idx, char) {
  return str.substring(0, idx + 1) + char + str.substring(idx + 1);
}

function expandUniverse(input) {
  const rows = input.split('\n');
  let expandedY = [];
  let expandedX = [];

  rows.forEach((row, y) => {
    if (!row.split('').some(char => char === '#')) {
      expandedY.push(y);
    }
  });

  for (let i = 0; i < rows[0].length; i++) {
    const column = rows.map(row => row[i]);
    if (column.some(char => char === '#')) {
      continue;
    }

    expandedX.push(i);
  }

  return {
    rows,
    expandedY,
    expandedX,
  };
}

const expansionRate = 1000000;

function solve(input) {
  const {
    rows: expanded,
    expandedY,
    expandedX,
  } = expandUniverse(input);
  const galaxies = new Map();
  
  expanded
    .forEach((row, y) => row.split('').forEach((char, x) => {
      if (char === '#') {
        galaxies.set(`${x},${y}`, { x, y });
      }
    }));

  const galaxieEntries = Array.from(galaxies.entries());

  const seen = new Set();
  const distances = [];
  galaxieEntries.forEach(g1 => {
    galaxieEntries.forEach(g2 => {
      if (g1[0] !== g2[0] && !(seen.has(`${g1[0]}-${g2[0]}`) || seen.has(`${g2[0]}-${g1[0]}`))) {
        seen.add(`${g1[0]}-${g2[0]}`);
        seen.add(`${g2[0]}-${g1[0]}`);

        const emptyY = expandedY.filter(y => (y > g1[1].y && y < g2[1].y) || (y > g2[1].y && y < g1[1].y));
        const emptyX = expandedX.filter(x => (x > g1[1].x && x < g2[1].x) || (x > g2[1].x && x < g1[1].x));
        const dx = Math.abs(g1[1].x - g2[1].x) + (emptyX.length) * (expansionRate-1);
        const dy = Math.abs(g1[1].y - g2[1].y) + (emptyY.length) * (expansionRate-1);
        distances.push(dx + dy);
      }
    });
  });

  return distances.reduce((acc, curr) => acc + curr, 0);
}

console.log(solve(i2));