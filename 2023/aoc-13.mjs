const i1 = `#.##..##.
..#.##.#.
##......#
##......#
..#.##.#.
..##..##.
#.#.##.#.

#...##..#
#....#..#
..##..###
#####.##.
#####.##.
..##..###
#....#..#`;

const i2 = `#.#.##.##.#
#..#..####.
#.#####..##
#.##..####.
##.#..####.
..#...#..#.
##...#....#
....##....#
##.##.#..#.
#..#.##..##
##.###.##.#
...#.#.##.#
.#.#.#.##.#
##.###.##.#
#..#.##..##

##.#...#.#.
##.##..#.#.
.#.##......
..######..#
..######..#
.#.##......
##.##..#.#.
##.#...#.#.
...##...#..
...#.###..#
#..#######.
..#.##.###.
..###.##.#.
..##.##.##.
..#.#..##..

#.....###..###.
.###....#..#...
.#..#.#..##..#.
##.##.#..##..#.
.#....#.#..#.#.
.###.#..#..#..#
#.###..######..
#..#...######..
..#.##.##..##.#
..#.##.##..##.#
#......######..

.##.#######
.##....##.#
#..#.#.#.##
#####....##
####.....##
#..#.#.#.##
.##....##.#
.##.#######
####.#.###.
#..#####..#
......#####
........###
#..###.###.

#..##..
#..#...
###.#..
##..###
####.##
..#.#..
..#.###
.##.##.
.##.##.
..#.###
..#.#..

##.##.#####
#.####.#.##
..#..#....#
#########..
########.##
...##...#.#
.#....#...#
########..#
..####.....
#......###.
#......###.
..####.....
########..#
.#....#...#
...##...#..
########.##
#########..

...#.#..#....#.
#.##..##.####.#
.##.#.##.#..#.#
#.#.#..##.##.##
..#.######..###
...#.###......#
.##...##......#
##..#.##.####.#
.###......##...
##..#..#..##..#
####.#..##..##.
.###..#.######.
#....##...##...
#.....#...##...
.###..#.######.

#..####
.##.#..
.##.#.#
#..####
#..####
.##.#.#
.##.#..
#..####
.##...#
#..###.
..###..

##.##.....#.#
##.##.......#
......#.##...
##.#.#..#.#..
##.#..#######
##...###..#..
##.##.#..#.##
####.#...#..#
###.....####.
...##....#...
...##.#.##.##
....#..#...##
###...#......

#####.##..#
#.#..######
.#.#...####
.#.#...####
#.#..######
###.#.##..#
...#.######
##.#...####
....#..####
.#.#....##.
.....#.#..#

.#....#.#..##
.#....#....##
..#..#.......
.##..##...###
##########..#
.#.##.#.###.#
..#..#...#.##
#.####.##..#.
.#....#..##..
#......###.##
.#.##.#..###.
...##...####.
.#....#...#..
##.##.####.##
##....##...##
#.####.####..
###..#####.##

.##.####....#
.##.#..####.#
#####...#.###
.......#.....
####.#...##..
.##....####.#
.##....######
.##....######
.##....####.#
####.#...##..
.......#.....
#####...#.###
.##.#..####.#
.##.####....#
.###..#...##.

#####.#.#.#..#.#.
#..###.###.##.###
....#...#..##..#.
#..####..#....#..
#..###..#.####.#.
#####.#.#..##..#.
#####.#.#####.##.
.##..###..####..#
#..#.#..########.
#..##.#####..####
####...#..#..#..#

########.....
...##.....##.
.........####
#.#..#.#####.
#.#######..#.
#.####.#.#..#
###..#####.#.
#.#..#.#..##.
..####....#.#
..####...#...
#.#..#.#.#..#
#.####.#.....
#.####.#.....

###....#.##.#.#
..#....#....###
#####.#..#.#.##
##.#.#..##..#..
..###..##...#..
#####.##...####
.....#...##.##.
###....####..##
##.###.##.###..
..##.####.#...#
###.##...#..###
..##.#..##.#...
..##.##.##.#...
###.##...#..###
..##.####.#...#

.#......#.#######
............####.
....##.....##..##
.###..###........
....##....#..##..
##.#..#.##.######
...####...#######
..######..##.##.#
.########..#.##..
###....#####.##.#
#...##...##......
...#..#...#..##..
##.####.##.......
.##....##.#..##..
#.##..##.#.#.##.#
.#.#..#.#.##.##.#
.##.##.##.##.##.#

....#.#.#..#.#.
####.#..#.#.#..
#..##.#.#..####
####..###......
....###.#.###..
....#.##....#.#
#..##.###.####.
....##.#...#...
#..#.#.#.#..###
####.#.#...##..
####.#.#...##..
#..#.#.#.#..#.#
....##.#...#...
#..##.###.####.
....#.##....#.#
....###.#.###..
####..###......

..#####....#####.
##..##########..#
.##.#..####..#.##
..######..######.
..######..######.
.##.#..####..#.##
##..##########..#
..#####....#####.
.....########....
..#..##....##..#.
.###.##.##.##.###
.#.#####..#####.#
..#....#..#.#..#.

.###.##.###
.###.##.###
####....#.#
#...####...
####....###
.#...##...#
..###..###.
#..#.##.#..
#....##....

#.#.#.#....#.
###..##.##.##
...##.#....#.
..##.#.####.#
##.#.#.#..#.#
.#..##..##..#
#.#...#....#.
...##.#....#.
...##.#....#.
#.#...#....#.
.#...#..##..#
##.#.#.#..#.#
..##.#.####.#

#......
.#.####
#.#####
.##...#
..#....
###.##.
##.####
.#..##.
.##....
##..##.
##..##.

##..#.#..#..###
##.#......#....
####....#.#####
.#.##.##.......
#..#.#..####..#
#..#.#..####..#
.#.##.##.......

.#..###.#
..#...##.
#####.#.#
....#.###
#.###.#.#
###.####.
##..#..#.
.#.#.....
.#.#.....
##..#..#.
###.####.
#.###.#.#
....#.###
#####...#
..#...##.
.#..###.#
.#..###.#

#.#.#.....###.##.
#.#.#.....###.##.
#...#.#.#####..#.
..#....#.####....
#.#.##.##..###..#
#.#....#.#.#.####
.##.#####........
.#.#.##..#####..#
.#.......#.######
..##.###.##.#####
####.#..##..#....
##..#.#.##.##.##.
#.#..#.#....##..#

#...#.####.#.#.##
#..#.#.#..##..#.#
.###...###..#....
####..###.###..##
##..##...###.##..
#.#.##.##..#.#..#
#.#.##.##.##.#..#
.##.#.##...###...
.##.#.##...###...
#.#.##.##.##.#..#
#.#.##.##..#.#..#

..........##.
.##.#.#.####.
####..###.###
####.#..#..##
.##.##.#...#.
....####...#.
.##...###..##
####.###.#.##
....###.#...#
#..#.##....#.
#..#.##.#..#.

.###...#.....
.###...#.....
..####.#####.
...#.##.##.##
#.###...###..
####.#.#.###.
#.#.#.##...##
#.#.#.##...##
####.###.###.
#.###...###..
...#.##.##.##
..####.#####.
.###...#.....

.###..#.#
.#.#..#.#
.#.###..#
##....###
##....###
.#.###..#
.#.#..#.#
.###..#.#
..###.#.#
.##.#.#.#
####..###
###..##.#
#.#.###.#
###..####
#.#.#.#.#
......#..
#..#####.

#...#..#..###..##
.#.##.#.##.......
.##.#.#...#......
#..#.#...###.##.#
#.#...###.#######
####.##..#...##..
##..#.####.######
..#.#..#.####..##
...######.###..##
####....###......
.#####.#.##..##..
.##..#..#........
####...###...##..

###.##..#
###.##..#
###.####.
##..#####
#....#..#
#..##.##.
..#..####

####......#######
####..##..#######
.##.#.##.#.##..##
###...##...######
..##..##..##.....
.#..#....#..#..#.
####..##..#######
#..###..###..##..
.####.##.####..##
.#..........#..#.
#..#..##..#..##..

....#..#..#..#..#
....#..#..#..#..#
#.#.#.###.#..#.##
..#..###...##...#
.#......##....##.
##..#...#.#..#.#.
#.#######.##.#.##
##...##.#..##..#.
####..#..######..
.##..#..##.##.##.
...#...#..####..#
#####.###......##
.#####.#.######.#
.#.....#.#.##.#.#
.###.......##....
.#...#....#..#...
.#.#..##..#..#..#

###...###
..#.#.#..
#.#...#.#
###.#.#.#
...##.#..
####..#.#
..#..#..#
###....#.
....#.#..
....#.#..
###....#.

..#..###.##
##.##.###..
..##....##.
..##..##.##
##..##.####
#####.#....
##.#....###

.#.#.##.#..
#....#.##..
#.#.###.###
#.##.###.##
.#.##...###
#..........
...##....##
#...#......
###.#.#....
###.#.#....
#...#......
.#.##....##
#..........
.#.##...###
#.##.###.##

..####...#.####.#
#......##..#..#..
#.#..#.#####..###
##....#####.##.##
..####......##..#
..#..#..#.#.##.#.
#..##..##.######.
..####..###....##
###..#######..###
.#.##.#.#..#..#..
.######.##.#..#.#

..##..###..
..#####....
...#.#.#.##
...#.#.####
..#####....
..##..###..
##......##.
##.#..#.###
###..##....
...##..##.#
##.###.#.#.
###.#.#....
..##...#..#
####.###.##
....#..#.##

#....##....
..##....##.
#.##....##.
.#...##...#
#..........
#####..####
#....##....

..#..#.
##.#.##
#..#...
#...##.
...#...
...#...
#...##.
#..#...
##.#.##
..#..#.
....#..
#.#..##
##....#
...#...
...##..

.####.####.
.###.......
..#####..##
...#.##..#.
#.#.###..##
.#..##....#
..#....##..
#.#.#.#..#.
#.#.#.#..#.

...#..####....#..
....#.###...##...
###....#...#.#...
...###...##....##
##.##..#..###.#..
#..#.#...#.#...##
..#....#...#..#..
..#....#...#..#..
#....#...#.#...##
##.##..#..###.#..
...###...##....##
###....#...#.#...
....#.###...##...
...#..####....#..
....#..###.#..###
#.....###....##..
....####....##...

#.#.#.#..#.#...#.
#..#.#.#..#...###
##.#..#.#.....#.#
###..#..#..#...##
##..#....#...#.#.
.##.#....#...##..
.##......#...##..
##..#....#...#.#.
###..#..#..#...##
##.#..#.#.....#.#
#..#.#.#..#...###
#.#.#.#..#.#...#.
.####...#..##.#..
####.##.#####.##.
.####.#####..#.#.
#...###.......###
#...###.......###

.#.##.#..##...#
###..###.##.#..
#.####.##..#.##
#.#..#......#..
#.#..#......#..
#.####.##..#.##
###..###.##.#..

...#.##.##.##.#..
##....######....#
##..#.##..##.#..#
###.#.######.#.##
..#...#.##.#...#.
...#.#.####.#.#..
..###.##..##.###.
....#...##...#...
..#..##....##..#.
.#.#.#..##..#.#.#
##....#.##.#....#
##.#####..#####.#
##....#....#....#
...###.####.###..
..#####....#####.
##...#.####.#...#
########..#######

####.##...##.##.#
#..##.######..#..
#..##.######.##..
..#.#..##########
.#.#..#.###.##.##
#.#.#..##...###.#
#....#..#.#.#....
#....#..#.#.#....
#.#.#..##...###.#
.#.#..#.###.##.##
..#.#..##########
#..##.######.##..
#..##.######..#..

##.#..#
######.
.#..#..
.....##
.....##
.#..#..
######.
##.#..#
.###.#.
..#.##.
....##.
.###.#.
##.#..#

##....###.#..##..
.#...##.##.##..##
#...##.###..#..#.
#..####...#######
#..####.#.#######
#...##.###..#..#.
.#...##.##.##..##
##....###.#..##..
###.#.###..#....#
#...##.#..#..##..
......#..#..#..#.
.#.....##...#..#.
..#...##.##......

.####.#
...#.##
#...###
#.##...
.##....
....#..
.#..#..
.....##
.##..##
#...###
#...###

##.#.##
#..#.#.
#.#..##
#.##.##
##..#..
..#.###
.#.####
.#..###
.#..###

#.##..###.#
...####.##.
.#.###.###.
#.....###..
..####.####
....#..#.##
....#..#.##
..####.####
#.....###..
.#.###.###.
...####.##.
#.##..###.#
#.##..###.#
...####.##.
.#.###.###.
#......##..
..####.####

.###...#...##
..##.#...#..#
....#.##.####
..#....###.#.
..###.##.####
..####..#...#
..##..#...#..
.......##..##
...#.#.####..
###.#.##.##..
..#.###.#.#.#
####.....#.##
###...#####.#
...#####.####
##.#.#####.##
##.#.#####.##
...#####.####

#..###.#..##.
.....#.....##
####....####.
....#.....###
#####.##.#.#.
.##..#####.##
.....##..####
#######..#.##
.##..##..#...
#####.#..###.
#..#.###..###
#..#.###..###
#####.##.###.
.##..##..#...
#######..#.##

..#..##.....#
###.#.##.###.
#.###.#######
####.#..#....
####.#..#....
#.###.#######
###.#.##.###.
..#..##.....#
#.######..##.
.#.##....##..
##.#.....##..
##.#.....##..
.#.##....##..
#.######..###
..#..##.....#

........####...#.
........####...#.
#...######.##.##.
.####.##.#...##.#
##..###.#......##
#....##.###.#....
#######....#.#.##
.####.#..#.###..#
.####.##...#.##.#

#####.#.#
#..##.##.
.....#...
#####..#.
.##.....#
....#.###
....#.###
.##.....#
#####..#.
.....#...
#..##.##.
#####.#.#
.##..#...
..#...#..
.##.##..#
....##...
####...#.

###....
#.###.#
###...#
.#.#.##
###.###
###.###
.#.#.##
###...#
#.###.#
###....
.#####.
#..#...
.####.#
.####.#
#..#..#
.#####.
###....

......#..####..#.
##..##.#.####.#.#
..##...##....##..
......#..####..#.
#.##.##..#..#..##
##..##.#.####.#.#
.........#####...
.#..#..###..###..
#....###..##..###
#######........##
#########....####
########..##..###
.......##.##.##..
######.##....##.#
......###....###.
......#..####..#.
##..##.#..##..#.#

..#..####..#.
..#..#..#..#.
##.##....##.#
...########..
###..###...##
##.##....##.#
..#..####..#.
##....##....#
..##########.
##.########.#
...##.##.##..

..####..####..##.
.###.####.###.##.
##.##....##.##..#
.####....####....
#.#.#.##.#.#..##.
#####.##.########
#...#....#...#..#

..##..#.##.##.##.
..##..###########
#....#..##.##.##.
.####.##.##..##.#
##..##..########.
######.##..##..##
#....##..#.##.#..
#....###..#..#..#
.....##.##....##.

.....#...##..####
.....#...#...####
.....#...#...####
.....#...##..####
.#..####...#...#.
#########.##..###
#####.##...##.#.#
..#.#.##.##...##.
....###..##.##.##
#.###..##.#..##.#
.....########..##
##..###.##..#####
.####.#.#..#...##
##..#..#.###.#.#.
#.##...##.#.....#
.#.#.....#.......
#...#####.######.

#......###.##.#
.##.##.#.#.##.#
######...######
.###.###..####.
###..####..##..
###..####..##..
.###.###..####.
######...######
.##.##...#.##.#
#......###.##.#
#.#####..##..##

#.##.#.#...
..##..##...
#.##.#.####
.#####.....
#....##..##
..##.......
.####......
#....#.#.##
##..###.#..
.####.#.###
..##..#....
#....#.....
.####.###..

#..###..#.####..#
#####.##..##..##.
####.#.##....##.#
####....#....#...
.##...#..####..#.
#####..#......#..
#..#.....####....

#####.#..##.##.
........#......
......##.###...
#####....#..#.#
.##....#######.
####.#..#.##...
.##.#.######.##
....#....###..#
#..#####....##.
.##.##..######.
......#.#.##.#.
####..#..####..
.##...#..##..##
#..##.#.###.#.#
#..###..#..#.##
.##.#..##..#.#.
.##.#...#..#.#.

.#.#..#.#.##.#.
##########..###
####..####..###
.###..###.##.##
##############.
#.##..##.####.#
##..##..######.

##..#.####.#.
....#.#..#.#.
....#.#..#.#.
##..#.####.#.
.##.#..##..#.
.#.#.#.##.#.#
#.#.#......#.
#..######.###
..#.##....##.
.#.####..####
....#..##..#.

....#####....
#######.####.
.#####.##..##
#.##.#..#..#.
#.###.#..####
..#...##.####
.#.#..#.#####
.#.#..#.#####
..#...##.####
#.###....####
#.##.#..#..#.
.#####.##..##
#######.####.
....#####....
....#####....

.......##
.##..##..
.##..##..
.......##
#....##.#
#..##.#.#
#####...#
####..###
....#.#..
#..#..#.#
........#
#####.###
....#..#.

#...##.
#....##
#####..
#.###.#
.###..#
.#.#..#
#.###.#
#####..
#....##
#...##.
#...##.

#.......####..###
.#.#..#.#........
##.#..#.####..###
...####...#....#.
#.#....#.#......#
#...##...#..##..#
##.####.##......#
###....###..##..#
.########.##..##.

#..#...####
#..##.#####
#..##.#..#.
#..##.#..#.
#..##.#####
#..#...####
##########.
.....#..#..
#..#.#.#.##
#...#.#.##.
#..#.#.###.
....####...
.....#.#..#
.....##.##.
.##.##.##.#
.....######
.##.#..##..

##.#....#..#.#.
####.##.#...##.
..##..###.##.##
........##..##.
...###.#..#...#
..#.##..#.#####
..####..##.####
...#...##.#.#..
..###.###.#....
##...##.#.#....
###..#.###...##
#####..####.##.
...#...##.#.###
..#....########
...#.#######.##
..##.#.#...##..
..##.#.#...#...

..#.##.#...
.#.#.......
########.##
..#..###..#
....#..###.
....#..###.
..#..###..#
#######..##
.#.#.......
..#.##.#...
.#.#.#.#.##
.#...#.#.#.
#####.#.##.
##...###..#
##...###..#

.#.....###.#.....
#.###...#.#......
...#...##....#..#
...#...##....#..#
#.###...#.#......
.#......##.#.....
#.#..########....
..##.##.#####.##.
#...##.#.##.#.##.
#....#..#....#..#
.#.###.##...#####
...##..#.........
.#..####.##.#....
......#.##...####
#..#######..#.##.

..##...#.#..#.#
...#.#.#......#
.##..###......#
.##..##.#....#.
#.#...##..##..#
#..#..###.##.##
#.##..#.##..##.
####..##......#
#.###.##.####.#
####.#..#....#.
.####..#......#
...##.##.####.#
#.####.#..##..#
.##.####..##..#
..#.####..##..#

.##..###..#.....#
.##.###.....#.##.
.##.###.....#.##.
.##..#.#..#.....#
.##......###..#.#
#..#.###.###..##.
......####.####.#
#..#.####..#..#..
.##.....##.##.###

....##...
##.####.#
##..##..#
##.####.#
##......#
####..##.
###.##.##
##......#
###....##
...#..#..
##..##..#
...#..#..
..######.
###....##
##.####.#
...####..
..######.

.#....#..
.##..##..
.######..
#.#..#.##
#...#..##
#.####.##
#..##..##
.##..##..
.#.##.#..
.#....#..
.##..##..
#.#..#.##
##....###
###..####
.#....#..

.....#.##.#
........#.#
...###..###
#.#.###.#.#
...#.#....#
..#.##.###.
..###....#.
###.##.###.
###.##.###.

..###.#..#.###...
..###......###...
#....#....#....##
.#..#.####.#..#..
#.##..#..#..##.##
...#.######.#..##
....##....##.....
...##########....
##..###..###..###
#.#.#......#.#.##
.#.##########.#..
#..###....###..##
..#....##....#...

.#....##.##..##.#
.#.####.#..##..#.
.#.##..#........#
..##.###..#..#..#
..#...###.#..#.##
#..#...##.####.##
#.#...#.###...##.
##.##..###.##.###
...#.##..........
...#.##..........
##.##..###.##.###

.###.##.###.#..##
..#.#..#.#...##.#
....#..#.....#.#.
..##....##..#.#.#
..##....##..#.#.#
....#..#.....#.#.
..#.#..#.#...##.#
.###.##.###.##.##
#....##....#####.
.##......##.#.##.
.##......##..###.
.##.#..#.##.###.#
#####..#####.####
...######...#.#.#
#..##..##..##.###

.....#.....
..#.#.#####
###..##....
##..#.#.##.
..######..#
...#..#....
#####..####
##.#....##.
...#..##..#
####.#..##.
##..##.....
...##.##..#
..###..#..#
#####...##.
......##..#
###...##..#
....#.##.##

..####.#.#....###
##...##..###.##.#
###.##.#..#....#.
###.##.#..#....#.
##...##..###.##.#
..####.#.#..#.###
.......######.#..
..#.##.....#.....
..#.##.##.#.####.

##..#.#.###.#
##..#.#.###.#
#.#..###..##.
...#.#...##.#
###.#.##..#.#
.#..####.#.##
.#####.##..#.
.######.#####
#..........#.
#..........#.
.######.#####
.#####.##..#.
.#..####.#.##
###.#.##.##.#
...#.#...##.#

...##.##.#.####
.#.#...#..#.##.
.#..#..####....
#####.#.#.##..#
.....###.#.#..#
......##.#.#..#
#####.#.#.##..#

#....######..##
#####.....#.#..
..##..#.#..#.##
..##..##..###..
..##.....##.###
#....###.###.##
##..##.#.#.##..

##..##.###..###
##..##.###..###
......#.####..#
..##.###.#.####
#....###...#.##
##..####..#.#..
.####.#.....#.#

###.####.##.#
........#..#.
..####.......
##....##....#
#.#..#.#.##.#
##.##.###..##
##.##.##....#
#.####.#....#
.#.##.#..##..

####....#.#..###.
.##.#..##...#..##
.##.#..##...#..##
####....#.#..###.
#####.#.#.##.....
..#.....#....###.
#..#.#...##.#..##
#..#####.##...#.#
######.#...#.#...

.#..#.#...#..
##..##.####..
..##...#..#..
.#..#...#..#.
.####....##..
#....##..####
.####.#.###..
......#.##.##
..##..#...#..
#....#.####..
..##....#####

#...#.#..##.#
#...#.#..##.#
###..##......
#########...#
.#..#.#.##...
#..####...#..
#..##..#..##.
#....##.....#
#....##.....#
#..##..#..##.
#..####...#..
.#..#...##...
#########...#
###..##......
#...#.#..##.#

#.#...#
...####
#.#.#..
####...
#....##
##.##..
##.##..

.##......##..
#..#.....##..
....##...##..
#..#.#...##..
#..##.#.####.
#..#.#...##..
.##...#..##..
#..###.##..##
....##.#....#
....#.....#..
#..#.##.####.
######...##..
####..#.#..#.
....#####..##
.##.#.##....#
#..##.#......
#..#.###....#

...#....#....#.
#.#......#.#..#
.#...##...#.#..
#.###..###.#...
#.#......#.##.#
##...##...#..#.
.#..#..#..#....
#..........#.#.
.#.#.##.#.#.#..
.#.#.##.#.#.#..
#..........#.#.

##.####.##.####.#
..#.##.####.##.#.
.#.####.##.####.#
#..#..#....#..#..
#..#..#....#..#..
##.#..#.##.#..#.#
#.##..##..##..##.
####..######..###
###.##.####.##.##
....##......##...
#.##..##..##..##.
#...##......##...
#.##..##..##..##.

#....#####.##..##
......#..##.#####
########.#.###.##
#.##.###.......##
..##...##..##....
......####.#.####
.......#..###....
####.#.#.###...##
###########..#...
.........#...#.##
......#.#....#...

.##.##.#.
#.#.##.##
#.......#
#.......#
#.#.##.##
.##.##.#.
.###..###
#..#..##.
.#.####..
####.....
#....#...
....#...#
.####.###
.#...#...
#.#######
#...#..##
#.#.#..##

.##.#####..
..#.#.##...
###.###.#..
###.##...#.
.#.#...##..
...#...#.#.
##.###....#
##.##.....#
...#...#.#.
.#.#...##..
###.##...#.
###.###.#..
..#.#.##...
.##.#####..
..#......##
##.#.#####.
##.#.#####.`;

function analyzeHorizontal(map, old = null) {
  const transformed = [];
  for (let x = 0; x < map[0].length; x++) {
    const row = [];
    for (let y = 0; y < map.length; y++) {
      row.push(map[y][x]);
    }
    transformed.push(row);
  }

  return analyzeVertical(transformed, old);
}

function analyzeVertical(map, old = null) {
  for (let x = 1; x < map[0].length; x++) {
    const found = map
      .map((row) => {
        let left = row.slice(0, x).reverse();
        let right = row.slice(x);
        const l = Math.min(left.length, right.length); 

        left = left.slice(0, l);
        right = right.slice(0, l);
        return JSON.stringify(left) === JSON.stringify(right);
      })
      .every((v) => !!v);

    if (found && old !== x) {
      return x;
    }
  }

  return null;
}

function solve(input) {
  const maps = input
    .split('\n\n')
    .map((map) => map.split('\n').map((row) => row.split('')));
  
  const vertical = maps.map(analyzeVertical);
  const horizontal = maps.map(analyzeHorizontal);

  const vertSum = vertical.filter(v => v !== null).reduce((a, b) => a + b, 0);
  const horSum = horizontal.filter(v => v !== null).map(v => v * 100).reduce((a, b) => a + b, 0);
  return vertSum + horSum;
}

function solve2(input) {
  let maps = input
    .split('\n\n')
    .map((map) => map.split('\n').map((row) => row.split('')));

  // maps = [maps[12]];
  // console.log(maps.map(m => m.map(r => r.join('')).join('\n')).join('\n\n'));
  
  const verticals = [];
  const horizontals = [];
  maps_loop: for (let i = 0; i < maps.length; i++) {
    const map = maps[i];

    for (let x = 0; x < map[0].length; x++) {
      for (let y = 0; y < map.length; y++) {
        const copy = JSON.parse(JSON.stringify(map));
        const curr = map[y][x];
        if (curr === '.') {
          copy[y][x] = '#';
        }
        if (curr === '#') {
          copy[y][x] = '.';
        }

        const oldV = analyzeVertical(map);
        const vertical = analyzeVertical(copy, oldV);
        if (vertical !== null && vertical !== oldV) {
          verticals.push({ i, x, y, vertical });
        }
        const oldH = analyzeHorizontal(map);
        const horizontal = analyzeHorizontal(copy, oldH);
        if (horizontal !== null && horizontal !== oldH) {
          horizontals.push({ i, x, y, horizontal });
        }

        if ((vertical !== null && vertical !== oldV) || (horizontal !== null && horizontal !== oldH)) {
          continue maps_loop;
        }
      }
    }
  }

  console.log(verticals, verticals.length);
  console.log(horizontals, horizontals.length);
  const vertSum = verticals.map(v=>v.vertical).filter(v => v !== null).reduce((a, b) => a + b, 0);
  const horSum = horizontals.map(v=>v.horizontal).filter(v => v !== null).map(v => v * 100).reduce((a, b) => a + b, 0);
  return vertSum + horSum;
}

console.log(solve2(i2));